\section{Event Topology and Spherical Harmonics Analysis}
\label{sec:topology_and_harmonics}

\subsection{Topology of $\vbb$-decay and $\B$ Events}
\label{subsec:topology}
%Signature of the $\vbb$-decay is two electrons with total kinetic energy equal to the isotope Q-value (e.g., 2.529~MeV for $\Te$). Therefore all $\vbb$-decay searches are designed to look for an excess of events in the energy spectrum around Q-value over the predicted number of background events. Backgrounds such as $\B$ solar neutrinos have distinct event topology that can be used to improve experimental sensitivity to the the $\vbb$-decay signal.

Electrons in the energy range around Q-value of all isotopes considered for $\vbb$-decay searches are above Cherenkov threshold in liquid scintillators. Each electron above the threshold will produce a fuzzy ring of Cherenkov light at the detector surface. The fuzziness of the ring depends on electron scattering. In most cases Cherenkov rings from low energy electrons degrade to randomly shaped clusters of Cherenkov photons around direction of the electron track. 

Large fraction of $\vbb$-decay events will have two Cherenkov clusters~\footnote{Only one Cherenkov cluster is produced when either the angle between the two $\vbb$-decay electrons is too small or when the energy splits between the electrons in such a way that one electron falls below the Cherenkov threshold.} as opposed to one cluster from $\B$ events. Therefore separation of $\vbb$-decay signal from $\B$ background depends on ability to identify topology of the Cherenkov light on the detector sphere on top of uniformly distributed scintillation light. We show that analysis of spherical harmonics of the early photons allows to achieve noticeable separation between $\vbb$-decay and $\B$ events.



%The simplest case for spherical harmonics analysis are events with the vertex located exactly in the center of the detector. For such event Cherenkov and scintillation light can be separated by applying a time cut on the photon arrival time as demonstrated in~\cite{Directionality}. To introduce the technique of spherical harmonics analysis we will follow the same strategy as in~\cite{Directionality} and use central events with a slightly different cut on the photon arrival time of 33.5~ns.

In order to illustrate differences between different event topologies we introduce three event topologies: two electrons produced back-to-back at 180$^{\circ}$ angle, two electrons at 90$^{\circ}$ angle, and a single electron. The two former are representative topologies of $\vbb$-decay signal events and the latter represents $\B$ background events. Figure~\ref{fig:Display_top_5MeV} shows Cherenkov photon distributions of 5~MeV electrons for each of the three topology. Overlay of 100 events with no QE applied is shown in order to make Cherenkov rings visible.


\begin{figure*}[h]
  \centering
  \includegraphics[width=0.3\textwidth]{hDisplay_topology180_5MeV.JPG}
  \includegraphics[width=0.3\textwidth]{hDisplay_topology90_5MeV.JPG}
  \includegraphics[width=0.3\textwidth]{hDisplay_1el_5MeV.JPG}
  \caption{Cherenkov photons distributions on the detector sphere for
    the three representative event topologies: two back-to-back
    electrons (\emph{left}), two electrons at 90$^{\circ}$ angle
    (\emph{middle}), and a single electron (\emph{center}).  All
    electrons are 5~MeV and originate at the center of the
    detector. 100 events overlayed for better visibility of the
    Cherenkov rings. 100\% QE is assumed. \JOcom{These can not be
      included as PDFs, but my conversion shrunk the size.}}
  \label{fig:Display_top_5MeV}
\end{figure*}

In practice Cherenkov rings from low energy electrons are not clearly
visible. Cherenkov clusters that form at lower energies are shown in Fig.~\ref{fig:Display_top_2p5MeV}. All Cherenkov photons produced in a single event are shown for the three event topologies with total kinetic energy of 2.529~MeV that corresponds to Q-value of $\Te$. One can try to guess the event topology by comparing different segments of the detector sphere.

\begin{figure*}[h]
  \centering
  \includegraphics[width=0.3\textwidth]{hDisplay_topology180_2p529MeVTot}
  \includegraphics[width=0.3\textwidth]{hDisplay_topology90_2p529MeVTot}
  \includegraphics[width=0.3\textwidth]{hDisplay_1el_2p529MeV}
  \caption{Cherenkov photons distributions on the detector sphere for
    the three representative event topologies: two back-to-back 1.26~MeV
    electrons (\emph{left}), two 1.26~MeV electrons at 90$^{\circ}$
    angle (\emph{middle}), and a single 2.529~MeV electron
    (\emph{center}).  All electrons originate at the center of the
    detector. One randomly selected event is chosen for each
    category. Default QE is applied.}
  \label{fig:Display_top_2p5MeV}
\end{figure*}

More realistic examples of $\Te$ $\vbb$-decay and $\B$ events simulated at the center of the detector are shown in Fig.~\ref{fig:Display_Te130}. Early PEs from Cherenkov and scintillation light are shown. Default simulation QE is applied. Time cut of 33.5~ns on the photon arrival time is used to select early PEs. Uniformly distributed scintillation light make it more difficult to guess the event topology. Nevertheless we show that there is still sufficient difference in the spatial distribution of the early PEs to separate two track and single track events.

\begin{figure*}[h]
  \centering
  \includegraphics[width=0.45\textwidth]{hDisplay_Te130_evt124_e1257_e1270_cos-0908}
  \includegraphics[width=0.45\textwidth]{hDisplay_Te130_evt131_e1264_e1263_cos-0029}
  \includegraphics[width=0.45\textwidth]{hDisplay_Te130_evt352_e1186_e1340_cos0888}
  \caption{Examples of PEs position on the detector sphere after time
    cut of 33.5ns. PEs from Cherenkov (\emph{red}) and scintillation
    light (\emph{blue}) are compared. \emph{Top left:} $^{130}$Te
    0{\nbb} decay back-to-back electrons: $E_1$=1.257~MeV,
    $E_2$=1.270~MeV, cos($\theta$)=-0.908. \emph{Top right:}
    $^{130}$Te 0{\nbb} decay electrons at $\sim$90$^{\circ}$:
    $E_1$=1.264~MeV, $E_2$=1.263~MeV,
    cos($\theta$)=-0.029. \emph{Bottom left:} $^{130}$Te 0{\nbb} decay
    electrons at $\sim$0$^{\circ}$: $E_1$=1.186~MeV, $E_2$=1.340~MeV,
    cos($\theta$)=0.888. \emph{Bottom right:} 2.529~MeV single
    electron. Events are simulated at the center of the
    detector. Default QE is applied.}
\label{fig:Display_Te130}
\end{figure*}


%$\vbb$-decay events become indistinguishable from single track topology when the angle between two electrons is small
For quantitative description of the difference in the event topology we analyze spherical harmonics of the photon distributions on the detector sphere. We construct rotation invariant variables and compare them between signal and background events. As it is shown in the bottom part of Fig.~\ref{fig:Display_Te130} $\vbb$-decay become indistinguishable from single track topology when the angle between two electrons is small (two degenerate tracks). Event topologies of $\vbb$-decay and $\B$ events are also very similar when only one electron from $\vbb$-decay is above the Cherenkov threshold. Therefore spherical harmonics analysis is most efficient for events with large angular separation between the two electrons and when both electrons are above Cherenkov threshold. 

In this paper we focus on topological difference between two tracks and single track events and do not make any attempt to use absolute directional information to suppress single track events  where direction of the track is consistent with the direction of solar neutrinos. Once a single track topology is established one can use a centroid method (see Ref.~\cite{Directionality}) to reconstruct directionality of the track (or two degenerate tracks) and suppress events that are aligned with the direction of $\B$ solar neutrinos.

\subsection{Description of Spherical Harmonics Analysis}
A function $f(\theta,\phi)$ can be decomposed to a sum of spherical harmonics:

\begin{eqnarray}
\label{eq1}
f(\theta,\phi) = \sum_{l=0}^{\infty} \sum_{m=-l}^{l} f_{lm} Y_{lm}(\theta,\phi),
\end{eqnarray}

where $Y_{lm}$ are Laplace's spherical harmonics defined in real-value basis using Legendre polynomials $P_l$:

\begin{eqnarray}
\label{eq2}
Y_{lm} = LONGformulaHERE,
\end{eqnarray}

 where  coefficients $f_{lm}$ are defined as
 
\begin{eqnarray}
\label{eq3}
f_{lm} = LONGformulaHERE.
\end{eqnarray}

Equation~\ref{eq4} defines power spectrum of $f(\theta,\phi)$ in spherical harmonics representation, $s_l$, where $l$ is a multiple moment. The power spectrum $s_l$ is invariant under rotation. It is unique to each of the functions $f_i(\theta,\phi)$, $i=$1,2,3..., that can not be transformed into each other by rotation.

\begin{eqnarray}
\label{eq4}
s_l = \sum_{m=-l}^{m=l} |f_{lm}|^2
\end{eqnarray}

One can consider PEs distribution for each of $\vbb$-decay signal or background event as a function $f_i(\theta,\phi)$. Events with similar power spectrum would correspond to PE distributions on the detector sphere that can be closely aligned by a rotation. Such PE distributions belong to events with similar topology.

Topology of $\vbb$-decay signal or background in a spherical detector determines the distribution of the PE's on the detector sphere and therefore a set of $s_l$'s can serve as a quantitative figure of merit for different event topologies. Rotation invariance of $s_l$'s ensures that this figure of merit does not depend on the orientation of the event with respect to the chosen coordinate frame.


Sum of $s_l$'s over all multiple moments equals to L2 norm of the function $f(\theta,\phi)$:

\begin{eqnarray}
\label{eq5}
\sum_{l=0}^{\infty} s_l = \int_{\Omega} |f(\theta,\phi)|^2 d\Omega.
\end{eqnarray}

Therefore normalized power spectrum 

\begin{eqnarray}
\label{eq5}
S_l = \frac{s_l}{\sum_{l=0}^{\infty} s_l} =  \frac{s_l}{\int_{\Omega} |f(\theta,\phi)|^2 d\Omega}
\end{eqnarray}

can be used to compare shapes of various functions $f(\theta,\phi)$ with different normalization. The total number of PEs detected on the detector sphere fluctuates from event to event, therefore in all of the following we use normalized power $S_l$.

Figure~\ref{fig:Moments} compares normalized power spectrum for the three representative event topologies that have been already shown in Fig.~\ref{fig:Display_top_5MeV}. We note that most of the information contains in the power spectrum with $l<$6. In most cases we found that there is no need to calculate $S_l$ for $l>$3 to achieve maximal separation between $\vbb$-decay and $\B$ events, because fluctuations in the PE distribution produce a lot of noise in the power spectrum for higher orders of multiple moments.


\begin{figure*}[h]
  \centering
  \includegraphics[width=0.95\textwidth]{Multiple_moment.JPG}
  \caption{Average $S_l$ values for two electrons at 180 degree
    (\emph{color1}) and 90 degree (\emph{color2}) 1.5~MeV each and a
    single electron (\emph{color3}) with the energy of 3~MeV. Error
    bars are RMS values of each corresponding individual $S_l$
    distribution (each consists of 1000 events simulated at the center
    of the detector) indicating typical event-by-event variation.}
\label{fig:Moments}
\end{figure*}


\subsection{Spherical Harmonics Analysis and Off-center Events}

In order to compare spherical harmonics for events with vertices located off-center anywhere inside the detector volume a coordinate transformation for each photon hit is needed. The necessary transformation applied for each PE within an event is illustrated in Fig.~\ref{fig:SphH_transform}. Solid circle with radius R schematically shows actual detector boundaries. Dotted circle shows a new sphere with the same radius R, which now has the event vertex in its center. The radius vector of each PE is stretched or shorten to its intersection with this new sphere using transformation $\vec{r}^{,}_{PE} = \frac{\vec{a}}{|\vec{a}|} \cdot R$. Where $\vec{r}^{,}_{PE}$ is a new radius vector of a PE and $\vec{a}=\vec{r}_{PE} - \vec{r}_{vtx}$ with $\vec{r}_{PE}$ and $\vec{r}_{vtx}$ being radius vectors of the PE and the vertex in the original coordinates respectively.

\begin{figure*}[h]
  \centering
  \includegraphics[width=0.95\textwidth]{SphH_transform_sketch.JPG}
  \caption{Coordinate transformation applied to events that are
    off-center. Solid circle schematically shows actual detector
    boundaries. Dotted circle shows a new sphere of radius R$=$6.5~m
    with the event vertex position in the center. The radius vector of
    each photon hit is stretched or shorten until intersection with
    this new sphere using transformation $\vec{r}^{,}_{hit} =
    \frac{\vec{a}}{|\vec{a}|} \cdot R$. Where $\vec{r}^{,}_{hit}$ is a
    new radius vector of the photon hit, $R$ is detector sphere radius,
    and $\vec{a}=\vec{r}_{hit} - \vec{r}_{vtx}$ with $\vec{r}_{hit}$
    and $\vec{r}_{vtx}$ being radius vectors of the photon hit and
    vertex position in original coordinates and correspondingly.}
  \label{fig:SphH_transform}
\end{figure*}


\subsection{Implementation of the spherical harmonics analysis}
{\bf A few words on the implementation. Calculation of $S_l$'s requires numerical integration that needs to be explained.}

To illustrate spherical harmonics analysis technique we compare distributions of $S_0$, $S_1$, $S_2$, and $S_3$ for the three representative event topologies described in Sec.~\ref{subsec:topology}. Almost all the information about event topology is carried by Cherenkov light. Therefore we first show spherical harmonics for back-to-back,  90$^{\circ}$ and single track topologies based on Cherenkov PEs only (see Fig.~\ref{fig:SL_topologies_CHE}).

Two top panels of Fig.~\ref{fig:SL_topologies_CHE} show 2-dimensional distributions, S0 vs S1 and S2 vs S3, to demonstrate that all four $S_l$'s provide separation between event topologies. No QE is applied in simulation of these events. We also introduce a 1-dimensional variable, S01 (bottom panel of Fig.~\ref{fig:SL_topologies_CHE}), that has the best separation power for majority of event topologies considered in this paper. $S_{01}$ is defined as a projection of S$_1$ vs S$_2$ distribution onto a linear fit of this 2-D distribution.

\begin{figure*}[h]
  \centering
  \includegraphics[width=0.49\textwidth]{ALL/hS0vsS1_topologies_CHELight_VtxSmear0cm_VtxShiftX0cm_33p5ns_center.pdf}
  \includegraphics[width=0.49\textwidth]{ALL/hS2vsS3_topologies_CHELight_VtxSmear0cm_VtxShiftX0cm_33p5ns_center.pdf}
  \includegraphics[width=0.9\textwidth]{ALL/hS01_topologies_CHELight_VtxSmear0cm_VtxShiftX0cm_33p5ns_center.pdf}
  \caption{Spherical harmonics for three event topologies: two
    back-to-back 1.26~MeV electrons (\emph{black squares and black
      dotted line}), two 1.26~MeV electrons at 90$^{\circ}$ angle
    (\emph{blue triangles and blue dashed line}), and a single
    2.529~MeV electron representing $^{8}$B background (\emph{red
      crosses and red solid line}). Simulation of 1000 events
    originated at the center of the sphere. Perfect separation between
    Cherenkov and scintillation light is implemented in this
    simulation by using only Cherenkov photons. \emph{Top left:} $S_0$
    versus $S_1$ scatter plot. Black dotted line is a linear fit of
    the 90$^{\circ}$ topology and $^{8}$B events. Variable $S_{01}$ is
    defined as a projection of 2D distribution onto this linear
    fit. \emph{Top right:} $S_2$ versus $S_3$ scatter
    plot. \emph{Bottom:} $S_{01}$ distributions for the three
    topologies. These distributions are normalized to unit area for
    shape comparison.}
  \label{fig:SL_topologies_CHE}
\end{figure*}


The effects due to presence of scintillation light and applying default QE are shown in Fig.~\ref{fig:SL_topologies_all}. Spherical harmonics of the same three representative event topologies are now calculated using early light (photons with arrival time less than 33.5~ns) that contains both directional Cherenkov light and uniform scintillation light. Default QE is also applied. Higher order multiple moments, S2 and S3, no longer provide noticeable separation between different event topologies.


\begin{figure*}[h]
  \centering
  \includegraphics[width=0.49\textwidth]{hS0vsS1_topologies_allLight_VtxSmear0cm_VtxShiftX0cm_33p5ns_center.pdf}
  \includegraphics[width=0.49\textwidth]{hS2vsS3_topologies_allLight_VtxSmear0cm_VtxShiftX0cm_33p5ns_center.pdf}
  \includegraphics[width=0.9\textwidth]{hS01_topologies_allLight_VtxSmear0cm_VtxShiftX0cm_33p5ns_center.pdf}
  \caption{Spherical harmonics for three event topologies: two
    back-to-back 1.26~MeV electrons (\emph{black squares and black
      dotted line}), two 1.26~MeV electrons at 90$^{\circ}$ angle
    (\emph{blue triangles and blue dashed line}), and a single
    2.529~MeV electron representing $^{8}$B background (\emph{red
      crosses and red solid line}). Simulation of 1000 events
    originated at the center of the sphere. Separation between
    Cherenkov and scintillation light is implemented 33.5~ns cut on
    the photon arrival time. Perfect vertex reconstruction - true
    vertex position is used. \emph{Top left:} $S_0$ versus $S_1$
    scatter plot. Black dotted line is a linear fit of the
    90$^{\circ}$ topology and $^{8}$B events. Variable $S_{01}$ is
    defined as a projection of 2D distribution onto this linear
    fit. \emph{Top right:} $S_2$ versus $S_3$ scatter
    plot. \emph{Bottom:} $S_{01}$ distributions for the three
    topologies. These distributions are normalized to unit area for
    shape comparison}
\label{fig:SL_topologies_all}
\end{figure*}

